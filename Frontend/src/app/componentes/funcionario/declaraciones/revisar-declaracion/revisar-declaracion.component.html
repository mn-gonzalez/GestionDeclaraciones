<div class="fondo">
    <h2 class="titulo">Declaración Jurada de Ingresos Año {{this.year}}</h2>
    <mat-horizontal-stepper [linear]="isLinear" #stepper>
        <mat-step [stepControl]="datosPersonales">
            <form [formGroup]="datosPersonales">
              <ng-template matStepLabel>Datos del Deudor</ng-template>
              <div class="formulario">
                <div class="datos_personales">
                    <h3>Datos Personales</h3>

                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>Rut</mat-label>
                        <input matInput placeholder="Ej. 12345678" formControlName="rut_deudor" readonly>
                    </mat-form-field>

                    <div class="form_nombre">
                        <mat-form-field appearance="outline" class="inputs" >
                            <mat-label>Nombres</mat-label>
                            <input matInput placeholder="Last name, First name" formControlName="nombres" readonly>
                        </mat-form-field>
            
                        <mat-form-field appearance="outline" class="inputs">
                            <mat-label>Apellido Paterno</mat-label>
                            <input matInput placeholder="Last name, First name" formControlName="ap_paterno" readonly>
                        </mat-form-field>
            
                        <mat-form-field appearance="outline" class="inputs">
                            <mat-label>Apellido Materno</mat-label>
                            <input matInput placeholder="Last name, First name" formControlName="ap_materno" readonly>
                        </mat-form-field>
                    </div>

                    <div class="div_estado_civil">
                        <label>Estado Civil:</label>
                        <mat-radio-group class="estado_civil" formControlName="estado_civil" [disabled]=true>
                            <mat-radio-button [checked]="this.datosPersonales.get('estado_civil')!.value == 1" 
                            (change)="verificacionEstadoCivil($event.value)" class="opciones" value=1>Soltero sin hijos</mat-radio-button>
                            <mat-radio-button [checked]="this.datosPersonales.get('estado_civil')!.value == 2" 
                            (change)="verificacionEstadoCivil($event.value)" class="opciones" value=2>Soltero con hijos</mat-radio-button>
                            <mat-radio-button [checked]="this.datosPersonales.get('estado_civil')!.value == 3" 
                            (change)="verificacionEstadoCivil($event.value)" class="opciones" value=3>Casado</mat-radio-button>
                            <mat-radio-button [checked]="this.datosPersonales.get('estado_civil')!.value == 4" 
                            (change)="verificacionEstadoCivil($event.value)" class="opciones" value=4>Casado con deudor Reprog.Cred.Univ. o Fiscal</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>
                

                <h3>Domicilio</h3>
                <div class="form_direccion">
                    <mat-form-field appearance="outline" class="input_direccion">
                        <mat-label>Dirección</mat-label>
                        <input matInput placeholder="Last name, First name" formControlName="direccion" readonly>
                    </mat-form-field>
        
                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>Región</mat-label>
                        <input matInput formControlName="region" name="region" readonly>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>Comuna</mat-label>
                        <input matInput formControlName="comuna" name="comuna" readonly>
                    </mat-form-field>
        
                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>Ciudad</mat-label>
                        <input matInput formControlName="ciudad"  name="ciudad" readonly>
                    </mat-form-field>
                </div>

                <h3>Datos de Contacto</h3>
                <div class="form_contacto">
                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>Teléfono</mat-label>
                        <input matInput placeholder="Last name, First name" formControlName="telefono" readonly>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>Correo Electrónico</mat-label>
                        <input matInput placeholder="Last name, First name" formControlName="correo" readonly>
                    </mat-form-field>
                </div>

                <h3>Datos del Trabajo</h3>
                <div class="form_trabajo">
                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>Institución en la que trabaja</mat-label>
                        <input matInput placeholder="Last name, First name" formControlName="trabajo" readonly>
                    </mat-form-field>
    
                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>Teléfono del trabajo</mat-label>
                        <input matInput placeholder="Last name, First name" formControlName="tel_trabajo" readonly>
                    </mat-form-field>
    
                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>AFP a la que esta afiliado</mat-label>
                        <input matInput formControlName="afp" name="afp" readonly>
                    </mat-form-field>
                </div>
              </div>

              <div class="botones">
                <div class="boton">
                    <button mat-stroked-button matStepperNext >Siguiente</button>
                </div>
              </div>
            </form>
        </mat-step>
        <mat-step [stepControl]="ingresosDeudor">
            <div>
                <form [formGroup]="ingresosDeudor">
                <ng-template matStepLabel>Ingresos del Deudor</ng-template>
    
                <div class="formulario_ingresos">
                    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" class="tabla">
                        <ng-container matColumnDef="mes">
                            <th mat-header-cell *matHeaderCellDef> Mes </th>
                            <td mat-cell *matCellDef="let element"> {{element.nombre}} </td>
                        </ng-container>

                        <ng-container matColumnDef="ingresos_pesos">
                            <th mat-header-cell *matHeaderCellDef> Monto en Pesos </th>
                            <td mat-cell *matCellDef="let element"> 
                                <mat-form-field>
                                    <input matInput formControlName="{{element.formControl}}" readonly>
                                </mat-form-field>
                            </td>
                        </ng-container>

                        <ng-container matColumnDef="utm">
                            <th mat-header-cell *matHeaderCellDef> Valor UTM </th>
                            <td mat-cell *matCellDef="let element">$ {{element.valor}} </td>
                        </ng-container>

                        <ng-container matColumnDef="ingresos_utm">
                            <th mat-header-cell *matHeaderCellDef> Monto en UTM </th>
                            <td mat-cell *matCellDef="let element"> 
                                <mat-form-field>
                                    <input matInput formControlName="{{element.formControlUTM}}" readonly>
                                </mat-form-field>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    </table>
                </div>

                <div class="botones">   
                    <div class="boton">
                        <button mat-button matStepperNext>Siguiente</button>
                    </div>
                </div>
                </form>
            </div>
        </mat-step>
        <mat-step [stepControl]="conyuge" *ngIf="casado">
            <form [formGroup]="conyuge">
              <ng-template matStepLabel>Datos e Ingresos del Conyuge</ng-template>

                <div>
                    <h3>Datos Personales</h3>

                    <mat-form-field appearance="outline" class="inputs">
                        <mat-label>Rut</mat-label>
                        <input matInput placeholder="Ej. 12345678" formControlName="rut_conyuge" readonly>
                    </mat-form-field>

                    <div class="form_nombre">
                        <mat-form-field appearance="outline" class="inputs" >
                            <mat-label>Nombres</mat-label>
                            <input matInput placeholder="Last name, First name" formControlName="nombres" readonly>
                        </mat-form-field>
            
                        <mat-form-field appearance="outline" class="inputs">
                            <mat-label>Apellido Paterno</mat-label>
                            <input matInput placeholder="Last name, First name" formControlName="ap_paterno" readonly>
                        </mat-form-field>
            
                        <mat-form-field appearance="outline" class="inputs">
                            <mat-label>Apellido Materno</mat-label>
                            <input matInput placeholder="Last name, First name" formControlName="ap_materno" readonly>
                        </mat-form-field>
                    </div>
                </div>

                <div>
                    <h3>Ingresos del Conyuge</h3>

                    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" class="tabla">
                        <ng-container matColumnDef="mes">
                            <th mat-header-cell *matHeaderCellDef> Mes </th>
                            <td mat-cell *matCellDef="let element"> {{element.nombre}} </td>
                        </ng-container>

                        <ng-container matColumnDef="ingresos_pesos">
                            <th mat-header-cell *matHeaderCellDef> Monto en Pesos </th>
                            <div class="div_form_ingresos" mat-cell *matCellDef="let element">
                                <mat-form-field  class="form_ingresos">
                                    <input matInput formControlName="{{element.formControl}}" id="{{element.id}}" readonly>
                                </mat-form-field>
                            </div>
                        </ng-container>

                        <ng-container matColumnDef="utm">
                            <th mat-header-cell *matHeaderCellDef> Valor UTM </th>
                            <td mat-cell *matCellDef="let element"> {{element.valor}} </td>
                        </ng-container>

                        <ng-container matColumnDef="ingresos_utm">
                            <th mat-header-cell *matHeaderCellDef> Monto en UTM </th>
                            <div class="div_form_ingresos" mat-cell *matCellDef="let element">
                                <mat-form-field  class="form_ingresos">
                                    <input matInput formControlName="{{element.formControlUTM}}" readonly>
                                </mat-form-field>
                            </div>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    </table>
                </div>

                <div class="botones">
                    <div class="boton">
                        <button mat-button matStepperNext>Siguiente</button>
                    </div>
                </div>
            </form>
        </mat-step>

        <mat-step [stepControl]="conyuge">
            <form [formGroup]="conyuge">
                <ng-template matStepLabel>Documentación</ng-template>
                <div class="formulario-documentacion">
                    <div>
                        <div class="label_documento">
                            <label>Certificado de Rentas</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_renta == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_renta != null" (click)="visualizarPDF('RENTAS_DEUDOR')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_renta.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="casado || casadoReprog">
                        <div class="label_documento">
                            <label>Certificado de Rentas Conyuge</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_renta_conyuge == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_renta_conyuge != null" (click)="visualizarPDF('RENTAS_CONYUGE')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_renta_conyuge.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="label_documento">
                            <label>Formulario N°22 Compacto</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_formulario22 == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_formulario22 != null" (click)="visualizarPDF('FORMULARIO_N22')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_formulario22.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="label_documento">
                            <label>Carpeta Tributaria Deudor</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_carp_tributaria_deudor == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_carp_tributaria_deudor != null" (click)="visualizarPDF('CARPETA_TRIBUTARIA_DEUDOR')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_carp_tributaria_deudor.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="casado || casadoReprog">
                        <div class="label_documento">
                            <label>Carpeta Tributaria Conyuge</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_carp_tributaria_conyuge == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_carp_tributaria_conyuge != null" (click)="visualizarPDF('CARPETA_TRIBUTARIA_CONYUGE')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_carp_tributaria_conyuge.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="label_documento">
                            <label>Certificado de Cotizaciones Previsionales</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_cotizaciones == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_cotizaciones != null" (click)="visualizarPDF('CERTIFICADO_COTIZACIONES')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_cotizaciones.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="casado || casadoReprog">
                        <div class="label_documento">
                            <label>Fotocopia de Libreta de Matrimonio</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_libreta_matrimonio == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_libreta_matrimonio != null" (click)="visualizarPDF('LIBRETA_MATRIMONIO')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_libreta_matrimonio.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="label_documento">
                            <label>Declaracion Jurada Notarial Simple del Deudor (debe acreditar
                                no haber percibido ingresos en tres o mas meses)</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_declaracion_sin_ingresos == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_declaracion_sin_ingresos != null" (click)="visualizarPDF('DEC_JURADA_SIMPLE_DEUDOR')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_declaracion_sin_ingresos.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="casado || casadoReprog">
                        <div class="label_documento">
                            <label>Declaracion Jurada Notarial Simple del Conyuge (debe acreditar
                                no haber percibido ingresos en tres o mas meses)</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_declaracion_sin_ingresos_conyuge == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_declaracion_sin_ingresos_conyuge != null" (click)="visualizarPDF('DEC_JURADA_SIMPLE_CONYUGE')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_declaracion_sin_ingresos_conyuge.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="label_documento">
                            <label>Finiquito de Trabajo Deudor</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_finiquito == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_finiquito != null" (click)="visualizarPDF('FINIQUITO_DEUDOR')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_finiquito.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="casado || casadoReprog">
                        <div class="label_documento">
                            <label>Finiquito de Trabajo Conyuge</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_finiquito_conyuge == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_finiquito_conyuge != null" (click)="visualizarPDF('FINIQUITO_CONYUGE')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_finiquito_conyuge.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="tieneHijos">
                        <div class="label_documento">
                            <label>Certificado de Nacimiento de Hijo</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_cert_nacimiento == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_cert_nacimiento != null" (click)="visualizarPDF('CERT_NACIMIENTO')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_cert_nacimiento.name}}</div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="casadoReprog">
                        <div class="label_documento">
                            <label>Copia de Pagaré de Conyuge, para deudores reprogramados Ley 19.287</label>
                        </div>
                        <div class="subir-documento">
                            <div *ngIf="this.documento_copia_pagare_conyuge == null" class="miniatura-pdf">
                                <span>No se ha seleccionado ningún archivo.</span>
                            </div>
                            <div *ngIf="this.documento_copia_pagare_conyuge != null" (click)="visualizarPDF('PAGARE_CONYUGE')" class="miniatura-pdf">
                                <img class="icono-pdf" src="../../../assets/imagenes/pdf.png" id="logo"/>
                                <div style="text-overflow: ellipsis; overflow: hidden; ">{{this.documento_copia_pagare_conyuge.name}}</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <button mat-button matStepperNext>Siguiente</button>
                </div>
            </form>
        </mat-step>
            
        <mat-step style="height: 100%;">
            <ng-template matStepLabel>Revisión</ng-template>
            <h4 style="padding-bottom: 20px;">Indicar las correcciones que debe hacer el deudor.</h4>
            <div style="width: 100%; height: 100%;">
                <label>Correcciones</label>
                <mat-form-field appearance="outline" style="width: 100%; height: 100%;">
                    <textarea matInput placeholder="Indicar corrección" [formControl]="comentarios"></textarea>
                </mat-form-field>
            </div>

            <div class="botones">
                <button mat-stroked-button (click)="aceptarDeclaracion()">Aceptar Declaración</button>
                <button mat-stroked-button (click)="corregirDeclaracion()">Devolver Declaración</button>
            </div>
        </mat-step>
    </mat-horizontal-stepper>
</div>

